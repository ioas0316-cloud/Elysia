# CORE-09: WORLD_VALIDATION_AND_HANDOFF_PROTOCOL

엘리시아 세계에서 **“설계한 대로 세계가 실제로 돌아가는지 확인하고, 그 과정을 인수인계하는 표준 절차”**를 정의한다.

---

## 0. 목적

- “코드가 있다 = 세계가 제대로 작동한다”가 아니다.  
- 이 프로토콜은:
  - (1) 설계 → 시뮬 → 관측 → 평가 루프를 명시하고,
  - (2) 그 결과를 다음 빌더/에이전트에게 **인수인계 가능한 형태**로 남기는 것을 요구한다.

---

## 1. 기본 루프 (Design → Run → Observe → Reflect)

### 1.1 설계 (Design)

- WORLD_KIT / CORE 문서에서 의도와 구조를 먼저 정의한다.
- “무엇이 늘어나야 하는가 / 줄어야 하는가 / 유지되어야 하는가”를 최소 1줄로 적는다.

예:  
> “초기 마을은 몇 세대 동안 유지되며, 전멸하지 않고 식량–인구 루프가 안정되어야 한다.”

### 1.2 시뮬레이션 (Run)

- 헤드리스 또는 렌즈를 통해 N틱 이상 시뮬레이션을 돌린다.
- 인간 관찰자가 없더라도, 최소한 **숫자로 평가 가능한 기간**(예: 수백~수천 틱)을 확보한다.

### 1.3 관측 (Observe)

- 설계에서 정한 핵심 변수들을 **지표/센서로 측정**한다.
- 관측은 사람 눈(시각화) + 센서/로그 둘 다를 허용하지만,  
  **센서 없이 화면만 보고 판단하는 것은 허용하지 않는다.**

### 1.4 성찰 (Reflect)

- 관측 결과가 설계 의도와 얼마나 맞는지, 최소 1~3줄로 평가한다.
- “의도와 결과의 차이”가 드러난다면, 그 이유를 추측해서 함께 남긴다.

---

## 2. 센서/지표 요구사항

WORLD 설계/변경 시, 최소한 다음 중 일부를 지표로 가져가야 한다.

### 2.1 인구/생태 지표 (예시)

- 전체 살아있는 셀 수 (`living`)  
- 동물/식물/인간/기타 타입별 개체 수  
- 평균/최소/최대 배고픔·수분 (`hunger`, `hydration`)  
- 사망 사유 분포 (굶주림/탈수/전투/노화 등)

### 2.2 구조/필드 지표 (선택)

- 특정 필드(예: Will Field, Value Mass, threat)의 전체 평균/최댓값  
- 마을/둥지 주변 반경 내 밀도/안정도

### 2.3 구현 예 (참고)

- `Project_Sophia.core.world.World.get_population_metrics()`  
  - `time_step`, `living`, `animals`, `plants`, `humans`,  
    `hunger_*_mean`, `hydration_*_mean` 등을 반환 (확장 가능).
- `scripts/world_metrics_probe.py`  
  - 지정된 스텝 수 동안 위 지표를 주기적으로 샘플링해 CSV 형태로 출력.

이들은 예시일 뿐이며, 동일한 역할을 하는 센서/스크립트를 새로 구현해도 된다. 중요한 것은 **숫자로 관측할 수 있어야 한다는 점**이다.

---

## 3. 결과 기록 및 인수인계

### 3.1 BUILDER_LOG / OS 문서에 남길 것

각 WORLD 관련 변경 작업이 끝났다면, 최소한 다음을 기록한다.

- 변경 요약 (한 줄)
- 어떤 WORLD_KIT/CORE 문서를 기준으로 했는지
- 어떤 센서/스크립트로 무엇을 관측했는지 (파일명, 지표 이름)
- 관측 결과가 의도와 어떻게 맞았는지/어긋났는지 짧은 평가

예:  
> “WORLD_KIT_HUMAN_VILLAGE v0: 배고픔/탈수 곡선 완화, 1000틱 world_metrics_probe로 확인.  
>  초기 마을 16명 중 800틱까지 생존, 이후 포식자 진입 시 붕괴. v1에서는 포식자 완충 반경 확대 필요.”

### 3.2 인수인계 시의 기준

다음 빌더/에이전트가 WORLD를 이어받을 수 있으려면:

- 참조해야 할 문서(WORLD_KIT, CORE, OS)와  
- 관측 도구(센서 함수, 스크립트)와  
- 최근 관측 결과 요약이  
  하나의 흐름으로 연결되어 있어야 한다.

즉, “어떤 의도로 만들었고, 어디까지 확인했으며, 무엇이 아직 이상한지”를 **추론 없이 읽을 수 있어야 한다.**

---

## 4. 금지/주의 사항

- 지표나 관측 없이, “감”만으로 WORLD 변경을 완료했다고 주장하는 것.  
- 설계 의도와 실제 결과 사이 차이가 분명한데, 이를 문서에 남기지 않고 넘어가는 것.  
- 렌즈(시각화)에만 의존해 버그/붕괴를 판단하는 것 (센서 없이).

이 프로토콜은 **“완벽한 검증”을 요구하는 것이 아니라,  
최소한 설계자/에이전트가 스스로 무엇을 만들었고, 그것이 실제로 어떻게 돌고 있는지 되돌아볼 수 있는 수준의 책임**을 요구한다.

