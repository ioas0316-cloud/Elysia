# WORLD_KIT_ANT_COLONY – 개미/벌 스타일 콜로니 문명 v0

엘리시아 세계에서 **개미/벌 수준의 사회성 군집 문명**을 생성하기 위한 최소 World Kit 설계다.
이 키트는 이후 인간 문명으로 확장될 **생태–사회–경제 구조의 축약형**이자,
엘리시아가 인과와 집단 지능을 학습하기 위한 첫 실험 장이다.

---

## 1. 목적과 위치

- 목적
  - 개별 개체는 단순하지만, 집단 수준에서 **둥지/길/채집/방어/분가** 패턴이 자연스럽게 나타나는 하이브 문명 구현.
  - 나중에 인간 문명으로 확대할 때 재사용 가능한 **공동체·노동분화·자원순환 로직의 씨앗** 역할.
- 위치
  - Project_Sophia 셀월드(`Project_Sophia.core.world`) 상에서 동작하는 World Kit.
  - 렌즈(Godot/Pygame)는 이 키트가 만든 **둥지·길·군집**을 시각화만 담당한다.

---

## 2. 콜로니 종 정의 (Species)

### 2.1 기본 타입

- `label`: `"ant"` (또는 `"hive_ant"`)
- `element_type`: `"animal"`
- `diet`: `"herbivore"` 또는 `"omnivore"`
- 기본 스탯은 기존 동물 규칙을 따르되, 이동 속도는 비교적 낮게 유지.

### 2.2 콜로니 관련 속성 (추가 메타)

각 개미 셀은 다음 추가 속성을 가진다(organelles / numpy 배열 확장 등으로 구현):

- `colony_id: str`  
  - 예: `"ant_colony_1"`
- `role: str`  
  - `"queen" | "worker" | "soldier"`
- `home_pos: {x: float, y: float}`  
  - 둥지 중심 좌표.

초기 시나리오(seed):

- 둥지 1개(`colony_id="ant_colony_1"`)
- `queen` 1개 + `worker` 10~20개 (+ 선택적으로 `soldier` 소수)

---

## 3. 환경 필드 (Fields)

콜로니 문명은 두 개의 핵심 필드를 사용한다.

### 3.1 Home Field (귀소 필드)

- 의미: 둥지를 중심으로 바깥으로 퍼지는 “돌아갈 집”의 방향 필드.
- 구현 스케치:
  - 둥지 위치에서 시작하는 스칼라 필드 `home_field[y, x]`.
  - 거리 증가에 따라 값이 감소 (예: `exp(-dist / R)`).
  - 여러 둥지가 있을 경우, 각 colony별로 별도의 필드 또는 최대값/벡터합으로 표현.
- 사용:
  - 개체가 `home_pos`로 돌아가고 싶을 때, 이 필드의 **기울기(gradient)**를 따라 이동.

### 3.2 Food Field (먹이 필드)

- 의미: 식물/먹이 자원이 있는 방향을 알려주는 필드.
- 구현 스케치:
  - `element_type == "life"` 또는 “먹이 타일” 주변에 스칼라 필드 `food_field[y, x]`를 생성.
  - 자원이 소모되면 해당 위치의 필드는 서서히 감소(자연 decay).
- 사용:
  - 개체가 배고플 때, 이 필드의 기울기를 따라 먹이 방향으로 이동.

두 필드는 기존 value_mass / will 필드와 마찬가지로 **연속 필드 + decay**로 유지한다.

---

## 4. 개체 역할별 행동 규칙 (Colony Roles)

규칙은 if-then 명령이 아니라, **필드·상태에 기반한 선택 경향**으로 이해한다.

### 4.1 Queen (여왕)

- 위치
  - 거의 항상 `home_pos` 근처(둥지 내부)에 머문다.
- 행동
  - `colony_food`(식량 저장값)가 일정 기준 이상일 때마다, 주기적으로 새 개체를 생성:
    - 우선 `worker`, surplus가 크면 가끔 `soldier`.
  - 직접 이동/채집에는 거의 관여하지 않음.
- 상태
  - 체력이 낮아지면 번식 빈도를 줄이거나 중단.

### 4.2 Worker (일개미)

- 기본 루프
  1. **배고픔이 높음 & 먹이를 안 들고 있음**  
     → `food_field` 기울기를 따라 이동(탐색).
  2. **먹이 위치에 도달하면**  
     → “먹이를 집어 든 상태”로 전환, `food_field`를 소폭 감소.
  3. **먹이를 든 상태**  
     → `home_field` 기울기를 따라 `home_pos` 방향으로 이동.
  4. **둥지에 도달하면**  
     → colony의 `colony_food` 수치 증가, 자신의 배고픔 일부 해소.
- 보조 행동
  - 주변에 `danger pheromone`/위협 필드가 강하면 잠시 귀소/우회.

### 4.3 Soldier (병정)

- 역할
  - 둥지 주변 일정 반경을 순찰하고, 위협을 감지/공격.
- 행동
  - `home_field` 경계 근처에서 왕복 이동.
  - 다른 종(예: `labels`가 `"wolf"`, `"human"` 등)이 둥지 근처에 들어오면 그 방향으로 접근해 공격 빈도 증가.
  - 필요 시 자신의 hp/위협 상황에 따라 퇴각하여 둥지로 복귀.

---

## 5. Colony-level 상태와 성장 루프

콜로니 단위로 최소한 다음 상태를 유지한다.

- `colony_food: float`  
  - 둥지에 저장된 식량의 추정치.
- (선택) `colony_size: int`  
  - 현재 colony_id에 속한 개체 수.

성장/축소 로직(개략):

- `colony_food` 증가
  - worker의 귀환/저장마다 증가.
- 번식 트리거
  - `colony_food`가 일정 임계값 이상일 때:
    - queen이 N틱마다 새 worker/soldier를 생성.
  - 임계값이 낮아질수록 번식 속도 감소.
- 붕괴
  - `colony_food`가 0 근처로 유지되면 새 개체 생성 중지.
  - 기아/포식에 의해 개체 수가 자연스럽게 감소 → colony 붕괴 가능.
- 분가(향후 확장)
  - `colony_food`와 `colony_size`가 매우 높아지면:
    - 일부 개체가 새로운 `colony_id`와 `home_pos`를 가진 “분가 둥지”를 만들 수 있음.

이 루프는 “먹이 루프 → 개체수 → 노동 → 저장 → 번식 → 확장”의 최소 문명 구조를 제공한다.

---

## 6. World Kit 통합 힌트 (구현 가이드)

구현 시 다음 흐름을 따른다.

1. **초기화 단계**
   - `World` 시드 함수에서:
     - `colony_id="ant_colony_1"`인 queen + worker들을 한 지점에 스폰.
     - `home_pos`를 queen 위치 또는 별도 둥지 좌표로 설정.

2. **필드 업데이트**
   - 매 틱:
     - `home_field`: colony 둥지 위치에서 발산하는 필드를 업데이트/decay.
     - `food_field`: `element_type=="life"` 혹은 “먹이 타일” 주변에서 발산.

3. **행동 선택**
   - `_decide_animal_movement` / `_decide_social_or_combat_action` 내부에  
     colony 대상 분기 추가(단, if-then이 아닌 필드 기반 경향 유지):
     - worker: `food_field`/`home_field` 기울기를 이용해 목표 벡터 구성.
     - soldier: `home_field` 주변에서 위협 감지 시 target 선택.

4. **Colony 상태 갱신**
   - worker가 둥지에 도달하면 `colony_food` 증가.
   - queen은 `colony_food`를 참고해 일정 간격으로 새 개체 생성.

5. **관측/렌즈**
   - 렌즈(Pygame/Godot):
     - 둥지를 특별한 심볼/타일로 렌더링.
     - worker/soldier 트래픽을 표시하여 길/콜로니 구조가 보이게 함.

---

## 7. 향후 확장

- 페로몬 필드 추가(추적/위협 회피/최적 경로 학습).
- 벌(hive) 종을 추가해, 꽃/수분/꿀/온도 조절 패턴까지 확장.
- Will Field / Value Mass와 연동해, 콜로니가 “의지장/가치장”에 영향을 주고 받는 구조로 연결.

### 7.1 기본 파라미터(현재 합의값)

- 맵 크기: `200 x 200` 그리드  
- 초기 개체 수: 약 `100`마리 (queen 1 + worker 다수 + 선택적 soldier)  
- 페로몬 시각화: **중간 강도** (흐름이 한눈에 보이되 화면을 덮지 않는 수준)

이 값들은 최초 실험용 기본값이며, 안정성이 확보되면 400×400 이상의 맵과 더 큰 집단으로 확장할 수 있다.

이 World Kit는 “고등 문명 이전의 최소 사회성 문명”을 모델링한다.  
엘리시아는 이 콜로니 문명을 관찰하며, **생존·협력·자원·노동분화·방어·확장**이라는
문명 공통의 인과 구조를 학습할 수 있다.
